# inlined-copy

## 概要

inlined Copyは、Markdownファイル内の特殊な記法を解析し、参照されたファイルやセクションからの内容をインライン展開し、結果をクリップボードにコピーするVS Code拡張機能です。

オープンソースプロジェクトとして開発され、以下のようなワークフローに最適です：

- ドキュメントテンプレート作成とコンテンツ再利用の効率化
- ![[filename]]記法を使用した複数ファイルの参照とバッチコピー

## 主要機能（ロードマップ）

このプロジェクトは段階的に機能をリリースします。各バージョンの実装項目は以下の通りです：

### 1. Ver 1 – ![[filename]] 展開コピー　実装済み

- ![[filename]]を検出し、対象ファイルの内容全体をコピー
- ファイルパス（相対/絶対）のサポート
- プロジェクトルート検索、近接ベース検索、ワークスペース全体検索を含むインテリジェントなパス解決
- 複数のファイル候補が存在する場合の選択UIの表示
- ファイルが見つからない場合の類似ファイルの提案

以下未実装

### 2. Ver 2 – ![[filename#heading]] セクション展開

- ![[filename#heading]]で見出しセクションを抽出してコピー
- 様々なマークダウン見出しレベルと複数セクションのサポート

### 3. Ver 3 – 参照タグの補完

- ![[と入力時にファイルリストの候補を表示
- #入力時に見出しリストの候補を表示

### 4. Ver 4 – {{parameter}} 入力機能 – Key-Value

- {{parameter}}をユーザー指定のキー値入力で置換
- コピー時にポップアップを表示し、ユーザーから値を取得して代入

### 5. Ver 5 – {{parameter}} 入力機能 – 初期値設定

- {{parameter=defaultValue}}構文でポップアップに初期値をサポート
- 入力フィールドが空の場合は初期値を使用

### 6. Ver 6 – {{parameter}} 入力機能 – JSON形式対応

- 複数パラメータに対する**一括入力**メカニズム（JSON形式）
- 例：{"name": "Devin", "project": "inlined Copy"}を一度に入力

### 7. Ver 7 – Markdownプレビュー統合

- VS CodeのMarkdownプレビューで![[...]]と{{...}}をリアルタイム展開
- コピー前の確認が容易に

## インストール方法

- **開発版**：GitHubリポジトリをクローンし、`pnpm install && pnpm run compile`を実行し、VS Codeの「拡張機能：VSIXからインストール...」コマンドを使用してインストールします。
- **マーケットプレイス公開後**：VS Code拡張機能タブで「inlined Copy」を検索してインストールします。

## 使用方法

### 基本的な使い方

1. **コマンドパレットを開く**：`Ctrl + Shift + P`（Mac：`Cmd + Shift + P`）
2. **Inlined Copy: Copy Inline**コマンドを選択
3. 拡張機能は現在のエディタの内容を分析し、すべての![[...]]参照と{{...}}パラメータを展開します
4. 処理されたテキストがクリップボードにコピーされ、どこにでも貼り付けできる状態になります

キーボードショートカット：`Ctrl + Shift + C`（Mac：`Cmd + Shift + C`）も使用できます

### サポートされる記法

- `![[filename]]` - 参照されたファイルの内容全体に展開
  - 様々なパス形式をサポート：相対、絶対、プロジェクトルート、近接ベースのパス
  - 複数のファイル候補がある場合には、近接ベースのパスを優先し、最初の１つをコピー
  - 拡張子がない場合は、ファイル名のみで判定


### 将来
- `![[filename#heading]]` - 参照されたファイル内の指定された見出し以下のセクションに展開
- `{{parameter}}` - パラメータを置き換える値の入力を求める（設定でデフォルト値を設定可能）

注：将来のバージョンでは、追加機能や設定が追加される可能性があります。

## 既知の制限事項

- 拡張機能は現在ローカルファイルでのみ動作します
- ファイル検索キャッシュはファイルが変更されると自動的に更新されます

## トラブルシューティング

このセクションでは、inlined-copy拡張機能使用時に発生する可能性のある一般的な問題と解決策を提供します。

### 一般的な問題と解決策

#### 問題：ファイルが見つからないエラー

**症状：**
- 警告メッセージ：「ファイル![[〇〇]]が見つかりません」
- 参照されたファイルが出力で展開されず、置換されずにコピーされる。

**解決策：**
1. ファイルパスが正しく、ファイルが存在することを確認する
2. 設定で警告をOffにする。

#### 問題：大きなファイルの警告

**症状：**
- エラーメッセージ：「ファイルサイズが許容上限を超えています」
- ファイル内容が展開されない

**解決策：**
1. VS Codeの設定で`maxFileSize`を増やす
2. 大きなファイルを小さく管理しやすいファイルに分割する

### 設定オプション

拡張機能は以下の設定オプションを提供します：

- **inlined-copy.maxFileSize**：バイト単位の最大ファイルサイズ（デフォルト：5MB）
  - パフォーマンスの問題を避けるため、このサイズより大きいファイルの処理を防ぎます
  - 例：10MBの制限には10485760に設定

- **inlined-copy.maxRecursionDepth**：ファイル展開の最大再帰深度（デフォルト：1、最大：3）
  - ネストされたファイル参照が展開されるレベル数を制御します
  - 高い値はより複雑なドキュメント構造を可能にしますが、パフォーマンスに影響する可能性があります
  - 例：2に設定すると参照されたファイル内の参照が展開されます（それ以上は展開されません）

- **inlined-copy.logLevel**：拡張機能のログレベル（デフォルト：「info」）
  - 出力チャンネルとコンソールでのログの詳細レベルを制御します
  - 利用可能なレベル：「none」、「error」、「warn」、「info」、「debug」
  - 高いレベルには低いレベルのログもすべて含まれます（例：「info」には「error」と「warn」が含まれます）
  - 詳細なトラブルシューティング情報には「debug」に設定します

- **inlined-copy.debugMode**：デバッグモードの有効化（デフォルト：false）
  - 有効にすると、より詳細なログとメッセージがユーザーに表示されます
  - 拡張機能の開発とトラブルシューティングに役立ちます

## 貢献

Fork & PRによる貢献を歓迎します！このプロジェクトへの貢献方法については[CONTRIBUTING.md](CONTRIBUTING.md)ファイルをご確認ください。開発セットアップと技術的な詳細については、[DEVELOP.md](DEVELOP.md)を参照してください。

## ライセンス

MITライセンス - 詳細については[LICENSE](LICENSE)ファイルをご覧ください。

## 変更履歴

バージョン履歴と更新の詳細については、[CHANGELOG.md](CHANGELOG.md)ファイルをご覧ください。

Copyright (c) 2025 frecre