# Devin向けタスク計画策定依頼

以下の3つの情報が後述されます：

- **プロジェクト基本情報**
- **タスク固有の補足情報**
- **タスク内容**

これらを踏まえて、**Devin(Claude sonnet 3.7)** に実行させたいタスクの **「計画策定依頼」** を.md形式で作成してください。

**注:** もしタスクが **10ACU（約3時間）を超える** 規模になりそうであれば、**o1 Pro側で複数の指示文プロンプトを分割出力** する想定です。計画策定時点で、依存関係や実装順を考慮した小規模タスク群に仕分けし、Devinが複数回にわたって対応できるようにしてください。

## 【依頼概要】

本依頼の目的は、Devinが **1タスクにつき 10ACU（約3時間）以内** で完了できる範囲を正しく認識し、必要に応じてサブタスクに分割しながら **「実行するための指示文（計画）」** を策定することです。

- タスクが複数に分割される場合は、**並行実行が可能か / 順次実行が必要か** を明記し、依存関係がある場合はその旨も示してください。
- **o1 Proが後工程で別々のタイミング・別々のプロンプト** として Devin に渡せるよう、**サブタスクごとに指示文を分ける** ことも考慮してください。

## 【指示書の要件】

1. **ジュニアエンジニア(Devin)が理解可能な具体的な手順書**

   - コード修正箇所の例示 (ファイル名・関数名など) や、実装のヒントを含めてもOK。
   - ただし不必要に冗長な説明は避け、**最小限かつ十分な情報**を盛り込む。
   - **10ACU(3時間)超過が懸念される場合は、適宜サブタスクを分割し、**複数の指示文に分けてもよいことを前提に計画を立てる。

2. **1タスクあたり 10ACU(3時間)以内で終わるよう範囲を限定**

   - タスクが大きい場合はサブタスクに分割し、各サブタスクも3時間程度に収める。
   - それぞれのサブタスクが **レビューしやすいPRの大きさ**(数十ファイル以下)になるよう配慮する。

3. **成果物の定義と提出先の明示**

   - 例: 「ブランチ名には Taskを識別する英単語 を含め、完了後にGitHubへプルリクを作成」
   - 「ローカル検証方法」(例: npm run dev でブラウザアクセスし正常動作を確認)
   - テスト実行や E2E チェックなど、完了判定ができる基準を明文化する。

4. **プロジェクトのルール遵守**

   - 「プロジェクト基本情報」(依存ライブラリ、コーディング規約、lintルールなど) と整合性を保つ。
   - 「タスク固有の補足情報」で指定された要件や制約を必ず反映させる。

5. **依存関係や前提タスクの順序**

   - 並行実行が可能なものと、順次実行が必須なものを明記する。
   - 他のタスク成果物を参照する場合は、そのタスクIDやPR番号を明示し、**別プロンプトとして切り出す計画**も検討する。

6. **Markdown形式で作成**

   - セクションや箇条書き、コードブロックを適宜使い、読みやすく整理する。

7. **AIエージェントがつまずきそうな箇所への補足・対策**
   - 環境変数の設定、認証情報の管理、ライブラリのバージョン、既存コードの取り扱いなど。
   - 特に規模が大きい機能を複数回に分割する際は、**タスク間で共有すべき前提や完成物**をあらかじめ明記する。

## 【出力例のイメージ】

### 指示文タイトル: [タスクID] XXX 機能の実装計画

#### 1. タスク概要

- この機能はユーザの○○を保存し、Supabase上で管理する。
- **分割要否**: ダークモード対応含む場合はサブタスクに分ける。(ex. サブタスクA=コントラスト比調整, サブタスクB=ダークモードテーマ統合)

#### 2. 前提情報

- 「プロジェクト基本情報」：コーディング規約は ESLint + Prettier
- 「タスク固有の補足情報」：RLS (Row Level Security) を有効にする必要あり

#### 3. 実装手順

1. Supabase の items テーブルへ カラム xxx を追加 (必要あればSQL例示)
2. Next.js で /items/[id] ページの API (API Routes) を拡張
3. フロントエンドフォームのUIを修正 (components/ItemForm.tsx)
4. ローカルで npm run dev → npm run test → E2Eテスト確認

#### 4. 成果物・完了条件

- ブランチ feature/items-crud-enhance でPRを作成
- LighthouseスコアがAA水準を満たす or コントラスト比要件を満たす
- 作業想定時間： **3時間以内**

#### 5. 注意事項

- RLSポリシー設定ファイル： .supabase/config/rls.sql
- カラーコードは shadcn/ui 既存テーマを基に拡張
- masterブランチからブランチを作成して作業すること。

#### 6. 並行/依存タスク

- [依存] #123: Supabase スキーマ管理タスク完了後に本タスク開始
- [並行可] #456: フロントのスタイル調整タスク
- **分割案**: このタスクが10ACUを超える場合、分割して複数の指示文プロンプトを作成

## プロジェクト基本情報

```markdown
# inlined-copy

## 概要

inlined Copyは、VSCode上でMarkdownファイルなどに記述された特殊記法を解析し、指定したファイル内容や見出し単位の内容をインライン展開してコピーする拡張機能です。

オープンソースとして開発され、以下のようなワークフローを想定しています:
* ドキュメントテンプレートやスニペット共有を効率化
* ![[ファイル名]] 記法で複数のファイルを参照して、一括コピー
* 見出し単位のコピーや、パラメータの差し替え（{{変数}}）にも対応

## 主要機能 (ロードマップ)

本プロジェクトは機能を段階的にリリースします。各バージョンの実装項目は次のとおりです:

### 1. Ver 1 – ![[ファイル名]] 展開コピー
* ![[ファイル名]] を検知して、対象ファイルの全文をコピー
* ファイルパス(相対/絶対)にも対応

### 2. Ver 2 – ![[ファイル名#見出し名]] 展開コピー
* ![[ファイル名#見出し名]]で見出しセクションを抽出してコピー
* マークダウンの見出しレベルや複数セクションへの対応など検討

### 3. Ver 3 – 参照タグの補完機能
* ![[入力時にファイル一覧の候補を表示
* #を入力したらファイル内の見出し一覧を候補として表示

### 4. Ver 4 – {{パラメータ名}} 入力機能 – Key-Value
* {{パラメータ名}} をユーザーが指定するKey-Value入力で置換
* コピー時にポップアップを表示し、ユーザーから値を取得して代入

### 5. Ver 5 – {{パラメータ名}} 入力機能 – 初期値設定
* {{パラメータ名=初期値}}のように書くと、初期値がポップアップに反映
* 入力欄が空の場合は初期値を使用

### 6. Ver 6 – {{パラメータ名}} 入力機能 – Json形式に対応
* 複数パラメータを**一括入力**可能にする仕組み (JSON形式)
* 例: {"name": "Devin", "project": "inlined Copy"} をまとめて入力

### 7. Ver 7 – Markdownプレビュー統合
* VSCodeのMarkdownプレビューで![[...]]や{{...}}をリアルタイム展開
* コピー前の確認が容易になる

## インストール

* **まだ未公開の場合**: GitHubリポジトリをクローンし、npm install && npm run compile後、VSCodeのExtensions: Install from VSIX...でインストール可能。
* **マーケットプレース公開後**: VSCodeの拡張機能タブで inlined Copy を検索し、インストール。

## 使い方 (基本)

1. **コマンドパレットを開く**: Ctrl + Shift + P (mac: Cmd + Shift + P)
2. **inlined Copy: Expand and Copy** コマンドを選択
3. **現在のエディタ内容**を解析し、![[...]] や {{...}} 等の特殊記法を一括で展開
4. 生成されたテキストをクリップボードにコピー→任意の場所に貼り付け

※ バージョンによって追加機能が増え、操作手順や設定が増えることがあります。

## 開発への参加 (Contributing)

* [Fork & PR] でのコントリビューションを歓迎します
* Issueを起票しバグ報告や機能提案を行ってください
* コード規約やLintなど、詳細はCONTRIBUTING.mdを参照（予定）

## ライセンス

* MIT License
```

## タスク固有の補足情報

```markdown
本タスクが関連するリリースのタスクリストは以下の通り。次工程のタスクを計画しない。本工程で必要なタスクは漏れないように注意する事。

# リリースごとのシンプルタスクリスト

## Ver 1: ![[ファイル名]] 展開コピー

### 1. 基本構造の準備
* yo codeによる拡張機能スキャフォールド作成
* package.jsonの設定（コマンド登録、キーボードショートカット、アクティベーションイベント）
* extension.tsの基本構造実装（アクティベーション処理、コマンド登録）
* GitHubリポジトリ初期化 & README記載

### 2. コマンド「Expand and Copy」の実装
* エディタのアクティブテキストを取得し、正規表現で![[ファイル名]]パターンを検出
* ファイルパス解決ロジック実装（絶対パス・相対パスの両方に対応）
* 指定ファイルを読み込んでテキストにインライン展開（複数パターン対応）
* 結合結果をクリップボードへコピーおよび成功通知表示

### 3. エラー処理 & フィードバック実装
* ファイルが見つからない場合のエラーハンドリング
* 大量/重複/循環参照の検出と対応
* ユーザーへの情報・警告・エラーメッセージ表示機能
* エラーログ出力機能

### 4. テスト計画と実装
* 単体テストの作成（ファイル検出、パス解決、テキスト置換など）
* 統合テストの作成（エンドツーエンドの機能テスト）
* 手動テストのチェックリスト作成
* エッジケースのテスト（大容量ファイル、特殊文字を含むパスなど）

### 5. デプロイと公開準備
* VSIX パッケージの作成とローカルテスト
* 公開用アセット準備（アイコン、スクリーンショット、詳細説明）
* ライセンスファイルの追加
* 初期バージョンのリリースノート作成

### 6. ドキュメント更新
* インストール手順の具体化
* 使用方法のステップバイステップガイド
* トラブルシューティングセクションの追加
* 次期バージョンの開発計画更新
```

## タスク内容
```
### 1. 基本構造の準備
* yo codeによる拡張機能スキャフォールド作成
* package.jsonの設定（コマンド登録、キーボードショートカット、アクティベーションイベント）
* extension.tsの基本構造実装（アクティベーション処理、コマンド登録）
* GitHubリポジトリ初期化 & README記載
```
